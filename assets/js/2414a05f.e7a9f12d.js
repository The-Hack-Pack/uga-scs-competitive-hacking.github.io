"use strict";(self.webpackChunkmain_website=self.webpackChunkmain_website||[]).push([["8415"],{9893:function(e,r,n){n.r(r),n.d(r,{frontMatter:()=>l,toc:()=>d,default:()=>u,metadata:()=>s,assets:()=>o,contentTitle:()=>c});var s=JSON.parse('{"id":"PasswordCracking/Level2/rulemaker","title":"Rulemaker","description":"Password Cracking | Level 2 - Rulemaker","source":"@site/docs/PasswordCracking/Level2/rulemaker.md","sourceDirName":"PasswordCracking/Level2","slug":"/PasswordCracking/Level2/rulemaker","permalink":"/practice/PasswordCracking/Level2/rulemaker","draft":false,"unlisted":false,"editUrl":"https://github.com/The-Hack-Pack/uga-scs-competitive-hacking.github.io/tree/development/docs/PasswordCracking/Level2/rulemaker.md","tags":[{"inline":false,"label":"Level 2","permalink":"/practice/tags/level2","description":"Level 2 challenges."}],"version":"current","lastUpdatedAt":1758073901000,"sidebarPosition":2,"frontMatter":{"description":"Password Cracking | Level 2 - Rulemaker","tags":["level2"],"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Diver","permalink":"/practice/PasswordCracking/Level2/diver"},"next":{"title":"Network Traffic Analysis","permalink":"/practice/category/network-traffic-analysis"}}'),a=n(2676),i=n(5608),t=n(5003);let l={description:"Password Cracking | Level 2 - Rulemaker",tags:["level2"],sidebar_position:2},c="Rulemaker",o={},d=[{value:"Challenge",id:"challenge",level:2},{value:"Solution",id:"solution",level:2},{value:"Credits",id:"credits",level:2}];function h(e){let r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components},{Details:n}=r;return n||function(e,r){throw Error("Expected "+(r?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.header,{children:(0,a.jsx)(r.h1,{id:"rulemaker",children:"Rulemaker"})}),"\n",(0,a.jsx)(r.p,{children:"Password Cracking | Level 2 - Rulemaker"}),"\n",(0,a.jsx)(r.h2,{id:"challenge",children:"Challenge"}),"\n",(0,a.jsx)(r.p,{children:"A password hash was retrieved that needs to be cracked. We know it's based on animals but there's some weird prepending & appending with numbers and common special characters. Can you crack the hash?"}),"\n",(0,a.jsxs)(r.p,{children:["Target Hash: ",(0,a.jsx)(r.code,{children:"9ac155fa85bf02a8712c1498c1c58799"})]}),"\n",(0,a.jsx)(t.Z,{hash:"281d94de86ee7784940315015a148730856f88fe6bd0babeedf4ec8a6a17cc372dd5d8524da97341d6929276618a5da2a22bad0d1b1ca4a8b517475002d2831e",algorithm:"sha512"}),"\n",(0,a.jsx)(r.h2,{id:"solution",children:"Solution"}),"\n",(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:"Solution Guide"}),(0,a.jsx)(r.admonition,{type:"note",children:(0,a.jsxs)(r.p,{children:["This challenge assumes you know how to solve ",(0,a.jsx)(r.a,{href:"https://thehackpack.org/practice/PasswordCracking/Level1/rockyou",children:(0,a.jsx)(r.strong,{children:"RockYou"})}),", ",(0,a.jsx)(r.a,{href:"https://thehackpack.org/practice/PasswordCracking/Level2/fusion",children:(0,a.jsx)(r.strong,{children:"Fusion"})}),", & ",(0,a.jsx)(r.a,{href:"https://thehackpack.org/practice/PasswordCracking/Level2/diver",children:(0,a.jsx)(r.strong,{children:"Diver"})}),"."]})}),(0,a.jsx)(r.p,{children:"You should know how to get the wordlist for animals (make sure to sanitize it, remove spaces, & make it lowercase). You'll notice that if you try any pre existing rules in hashcat, you won't get the password. This is because this challenge requires you to craft your own rules."}),(0,a.jsx)(r.hr,{}),(0,a.jsxs)(r.p,{children:[(0,a.jsx)("h2",{children:"How to make rules in Hashcat"}),"\r\nAs you know from ",(0,a.jsx)(r.a,{href:"https://thehackpack.org/practice/PasswordCracking/Level2/diver",children:(0,a.jsx)(r.strong,{children:"Diver"})}),", Hashcat rules let you transform every word in your wordlist using lightweight text manipulation instructions. It\u2019s like regex, but much more optimized and tuned specifically for password cracking."]}),(0,a.jsx)(r.p,{children:"Rules are written one instruction per line, with each instruction telling Hashcat how to modify the base word. You can do things like:"}),(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsxs)(r.li,{children:["Add characters (",(0,a.jsx)(r.code,{children:"$!"})," adds ",(0,a.jsx)(r.code,{children:"!"})," to the end, ",(0,a.jsx)(r.code,{children:"^@"})," adds ",(0,a.jsx)(r.code,{children:"@"})," to the beginning)"]}),"\n",(0,a.jsxs)(r.li,{children:["Change case (",(0,a.jsx)(r.code,{children:"u"})," = uppercase all, ",(0,a.jsx)(r.code,{children:"l"})," = lowercase all, ",(0,a.jsx)(r.code,{children:"c"})," = capitalize)"]}),"\n",(0,a.jsxs)(r.li,{children:["Substitute characters (",(0,a.jsx)(r.code,{children:"saz"})," changes ",(0,a.jsx)(r.code,{children:"a"})," to ",(0,a.jsx)(r.code,{children:"z"}),")"]}),"\n",(0,a.jsx)(r.li,{children:"Insert/delete characters at specific positions"}),"\n",(0,a.jsx)(r.li,{children:"Combine multiple operations in one line"}),"\n"]}),(0,a.jsx)(r.p,{children:"There's 2 types or rules: mutators (modify/replace characters) & additives (add/remove characters)"}),(0,a.jsxs)(r.p,{children:["Here\u2019s a quick cheat sheet & guide: ",(0,a.jsx)(r.a,{href:"https://kaoticcreations.blogspot.com/2011/09/explanation-of-hashcat-rules.html",children:"https://kaoticcreations.blogspot.com/2011/09/explanation-of-hashcat-rules.html"})]}),(0,a.jsxs)(r.p,{children:["You can combine rules like this: ",(0,a.jsx)(r.code,{children:"^@ c $1"}),".\r\nThat will take a word like ",(0,a.jsx)(r.code,{children:"tiger"})," and turn it into ",(0,a.jsx)(r.code,{children:"@Tiger1"}),"."]}),(0,a.jsxs)(r.p,{children:["Once you have all the rules writted down in a text file, you can save it as ",(0,a.jsx)(r.code,{children:"<name>.rule"}),". To use a rule, just append your traditional dictionary attack command with ",(0,a.jsx)(r.code,{children:"-r yourRule.rule"}),"."]}),(0,a.jsxs)(r.p,{children:[(0,a.jsx)("h3",{children:"Rule stacking"}),"\r\nYou can stack & combine multiple rule files (can be same or different). So let's say you have a rule file named ",(0,a.jsx)(r.code,{children:"my.rule"}),", you can stack and make it apply twice by executing:"]}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"hashcat -a 0 -m <mode> hash.txt wordlist.txt -r my.rule -r my.rule\n"})}),(0,a.jsx)(r.p,{children:"This helps you make smaller rule files with the function of bigger ones."}),(0,a.jsx)(r.hr,{}),(0,a.jsxs)(r.p,{children:["Alright, now let's apply this new knowledge we've learned and make our own rule file! We know that we want to prepend and append special characters and numbers. Recall that prepending is done with ",(0,a.jsx)(r.code,{children:"^"})," and appending is done with ",(0,a.jsx)(r.code,{children:"$"}),". So, let's make our rule file (you can do it manually or write a script to automate it)!"]}),(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:"Reveal rule file"}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-txt",children:'$~\r\n$`\r\n$!\r\n$@\r\n$#\r\n$$\r\n$%\r\n$^\r\n$&\r\n$*\r\n$(\r\n$)\r\n$-\r\n$_\r\n$+\r\n$=\r\n${\r\n$}\r\n$[\r\n$]\r\n$|\r\n$\\\r\n$;\r\n$:\r\n$"\r\n$<\r\n$>\r\n$,\r\n$.\r\n$/\r\n$?\r\n$0\r\n$1\r\n$2\r\n$3\r\n$4\r\n$5\r\n$6\r\n$7\r\n$8\r\n$9\r\n^`\r\n^!\r\n^@\r\n^#\r\n^$\r\n^%\r\n^^\r\n^&\r\n^*\r\n^(\r\n^)\r\n^-\r\n^_\r\n^+\r\n^=\r\n^{\r\n^}\r\n^[\r\n^]\r\n^|\r\n^\\\r\n^;\r\n^:\r\n^"\r\n^<\r\n^>\r\n^,\r\n^.\r\n^/\r\n^?\r\n^0\r\n^1\r\n^2\r\n^3\r\n^4\r\n^5\r\n^6\r\n^7\r\n^8\r\n^9\n'})})]}),(0,a.jsxs)(r.p,{children:["Let's name it something like ",(0,a.jsx)(r.code,{children:"additive1.rule"})," and try it out!"]}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"hashcat -a 0 -m 0 hash.txt animals.txt -r additive1.rule\n"})}),(0,a.jsx)(r.admonition,{type:"tip",children:(0,a.jsxs)(r.p,{children:["Appending ",(0,a.jsx)(r.code,{children:"-S"})," to your hashcat commands helps improve performance when you're using bigger rule files (this challenge won't use a big one)"]})}),(0,a.jsx)(r.p,{children:"...and you notice it gives you nothing. Well maybe this is because the rule is only prepending or appending one character, our password could potentially have more. So, let's try rule stacking! Apply this rule twice or more times if needed!"}),(0,a.jsxs)(n,{children:[(0,a.jsx)("summary",{children:"Reveal Final Command"}),(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-bash",children:"hashcat -a 0 -m 0 hash.txt animals.txt -r additive1.rule -r additive1.rule -r additive1.rule\n"})})]}),(0,a.jsx)(r.p,{children:"You should now have cracked the password!"})]}),"\n",(0,a.jsx)(r.h2,{id:"credits",children:"Credits"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:"Author(s): Divesh Gupta (legendile7)"}),"\n"]})]})}function u(e={}){let{wrapper:r}={...(0,i.a)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},5003:function(e,r,n){n.d(r,{Z:()=>l});var s=n(2676),a=n(5271),i=n(5778),t=n.n(i);let l=({hash:e,algorithm:r})=>{let[n,i]=(0,a.useState)(""),[l,c]=(0,a.useState)("");return(0,s.jsxs)("div",{children:[(0,s.jsxs)("form",{onSubmit:s=>{s.preventDefault(),((e,r)=>{let n=e.toLowerCase();switch(r){case"sha1":return t().SHA1(n).toString();case"sha512":return t().SHA512(n).toString();default:return n}})(n,r)===e?c("Correct!"):c("Incorrect. Try again.")},children:[(0,s.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),placeholder:"Enter answer"}),(0,s.jsx)("button",{type:"submit",children:"Check"})]}),(0,s.jsx)("p",{children:l})]})}},2955:function(){}}]);